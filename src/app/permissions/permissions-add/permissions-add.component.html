<!--
  ~ /*
  ~ *      2018 InfAI (CC SES)
  ~ *
  ~ *    Licensed under the Apache License, Version 2.0 (the “License”);
  ~ *    you may not use this file except in compliance with the License.
  ~ *    You may obtain a copy of the License at
  ~ *
  ~ *        http://www.apache.org/licenses/LICENSE-2.0
  ~ *
  ~ *    Unless required by applicable law or agreed to in writing, software
  ~ *    distributed under the License is distributed on an “AS IS” BASIS,
  ~ *    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ *    See the License for the specific language governing permissions and
  ~ *    limitations under the License.
  ~ */
  -->

<div class="outer">
  <form [formGroup]="form">
    <mat-horizontal-stepper>
      <mat-step label="Subjekt">
        <mat-select formControlName="subject" placeholder="User">
          <mat-option *ngFor="let user of users" [value]="user.username">{{user.username}}</mat-option>
        </mat-select>

        <mat-select formControlName="subject" placeholder="Rolle">
          <mat-option *ngFor="let role of roles" [value]="role.name">{{role.name}}</mat-option>
        </mat-select>

        <div class="control_buttons">
          <button color="primary" mat-raised-button matStepperPrevious>Zurück</button>
          <button color="primary" mat-raised-button matStepperNext>Weiter</button>
        </div>
      </mat-step>
      <mat-step label="Regel">
        <div class="rule" [formGroup]="form['controls'].actions['controls'][i]" *ngFor="let action of form['controls'].actions['controls']; let i=index">
          <div class="action_checkboxes">
            <mat-checkbox formControlName="get">GET</mat-checkbox>
            <mat-checkbox formControlName="post">POST</mat-checkbox>
            <mat-checkbox formControlName="patch">PATCH</mat-checkbox>
            <mat-checkbox formControlName="delete">DELETE</mat-checkbox>
            <mat-checkbox formControlName="put">PUT</mat-checkbox>
          </div>

          <mat-form-field class="example-full-width">
            <input matInput formControlName="endpoint" placeholder="API Endpoint"/>
          </mat-form-field>

          <mat-select formControlName="endpoint" placeholder="Endpoint">
              <mat-option *ngFor="let uri of uris" [value]="uri">{{uri}}</mat-option>
            </mat-select>

        </div>

        <button (click)="addAction()" color="primary" mat-raised-button>Weitere Regel</button>


        <div class="control_buttons">
          <button color="primary" mat-raised-button matStepperPrevious>Zurück</button>
          <button (click)="submit()" color="primary" type="submit" mat-raised-button matStepperNext>Absenden</button>
        </div>
      </mat-step>
      <mat-step label="Ergebnis">
        <div *ngIf="submit_failed">
          <p>Policy konnte nicht erfolgreich erstellt werden</p>
        </div>
        <div *ngIf="!submit_failed">
          <p>Policy wurde erfolgreich erstellt</p>
        </div>
        <div class="control_buttons">

          <button color="primary" mat-raised-button (click)="showAll()">Alle Regeln</button>
          <button color="primary" mat-raised-button matStepperPrevious>Neue Regel erstellen</button>

        </div>
      </mat-step>
    </mat-horizontal-stepper>
  </form>

  <section>
  </section>
</div>
